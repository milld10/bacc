\section{Bluetooth Security} \label{bluetooth}
This Chapter discusses the security of Bluetooth and particular of \gls{ble}. \\
Nowadays \gls{ble} is a common wireless standard for communication \cite{IntroductionBLE}. This technology is useful for many applications such as sports devices, sensors and also medical devices \cite{Ryan13}.
As already discussed in Section \ref{background}, the protocol stack of \gls{ble} differs from the stack of classic Bluetooth. The protocol layers were simplified to achieve lower power consumption \cite{Ryan13}. As a result, the privacy of the communication is compromised.

As described in \cite{GomezOP12}, \gls{ble} connection is securely encrypted. While \cite{Ryan13} states that the session encryption is in fact relatively secure, the key exchange is exploitable. The main security issue lies in the pairing process between the two devices. Therefore, attacks such as passive eavesdropping, \gls{mitm} and identity tracking are possible, as stated in \cite{IntroductionBLE}.

The pairing process consists of three phases. After connection of devices, a \gls{stk} is generated. For this, the devices agree on a \gls{tk}. Depending on the pairing mode, the value of the \gls{tk} changes \cite{Ryan13}. Based on the \gls{tk}, the \gls{stk} is generated. The final step of the pairing process is the generation of the \gls{ltk}. \\
For the pairing modes Just Works\texttrademark and 6-digit-pin, the \gls{tk} can be quickly brute forced with a single core Intel Core i7 CPU. This makes a \gls{ble} connection vulnerable because, with retrieval of the \gls{tk}, the \gls{ltk} can be recovered. The \gls{ltk} is needed for Link Layer encryption and authentication. Hence, if the \gls{ltk} can be retrieved, the security of future communication between the paired devices is massively compromised, and future messages can be decrypted \cite{Ryan13}. \\
\cite{GomezOP12} even states that \gls{ble} is vulnerable since all pairing methods cannot be protected against passive eavesdropping. 

Packet sniffer tools, such as the open source tool \textit{Btlejack}, make it possible to records information between connected devices \cite{BtleJack}. This makes MITM attacks simple, and credentials can be retrieved in plaintext. \\
The reason we rely on \gls{ble} technology is for utilizing the Web Bluetooth \gls{api} for the Google Chrome browser \cite{WebBTAPI}. The \gls{api} is experimental and so far only supports \gls{ble} connections. 

As mentioned above, research \cite{Ryan13} states that as soon as the \gls{ble} connection has been established, it is secure. The risk lies in the potentially insecure pairing process between two devices. To reduce this risk, the pairing process must happen in a secure environment.
